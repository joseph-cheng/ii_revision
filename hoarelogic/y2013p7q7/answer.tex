\input{../../template.tex}

\begin{document}
\begin{enumerate}[label=(\alph*)]

  \item
    In order to know that our code is correct, we often want to verify that it adheres to some specification, for which we might use Hoare logic or separation logic. However, doing these proofs by hand is tedious and error-prone, and so we would like many of the tedious parts of this process to be mechanised, so humans only have to provide the parts that require human intellect (like the specification and loop invariants). Verification conditions are conditions generated by verification condition generation as part of mechanised program verification. If we can prove that the verification conditions are true, then we know that the program specification is satisfied.

    \item
      The VCs generated for this program are just the following VC:

      $P \implies Q[E_3 / V_3][E_2 / V_2][E_1 / V_1]$

      Suppose the VC is true, we are required to prove that the specification is provable in Hoare logic.

      $\{Q[E_3 / V_3]\}V_3 := E_3 \{Q\}$ by the assignment rule

      $\{Q[E_3 / V_3][E_2 / V_2]\}V_2 := E_2 \{Q[E_3 / V_3]\}$ by the assignment rule

      $\{Q[E_3 / V_3][E_2 / V_2][E_1 / V_1]\}V_1 := E_1 \{Q[E_3 / V_3][E_2 / V_2]\}$ by the assignment rule

      $\{Q[E_3 / V_3][E_2 / V_2][E_1 / V_1]\}V_1 := E_1;V_2 := E_2;V_3 := E_3 \{Q\}$ by sequencing

      $\{P\}V_1:=E_1;V_2:=E_2;V_3:=E_3 \{Q\}$ by rule of consequence.

      \item
        We have three VCs: loop initialisation, invariant preservation, and loop postcondition:

        $T \implies Inv[1 / Y][0 / X][0 / I]$

        $(Inv \wedge I \neq N) \implies Inv[X + Y / Y][X + Y / X][I + 1 / I]$

        $(Inv \wedge \neg (I \neq N)) \implies X = fib(2 \times N)$

        \item
          We propose $Inv = \{X = fib(2 \times I) \wedge Y = fib(2 \times I + 1)\}$

          The first verification condition comes immediately, since $0 = fib(2 \times 0) \wedge 1 = fib(2 \times 0 + 1)$ is a tautology.

          The second verification condition requires us to prove $\{X + Y = fib(2 \times (I + 1)) \wedge X + Y + Y = fib(2 \times (I + 1) + 1)\}$ From $Inv \wedge I \neq N$

          $Inv$ tells us that $X = fib(2I)$ and $Y = fib(2I + 1)$, so we get by definition that $X + Y = fib(2I + 2) = fib(2(I + 1))$

          Then, $X + Y + Y = fib(2I+2) + fib(2I+1) = fib(2I+3)$ by definition, and then $fib(2I+3) = fib(2(I+1) + 1)$

          So we have invariant preservation.

        Finally, if we have $Inv \wedge \neq (I \neq N))$, then we have $Inv \wedge I = N$, which immediately gets us $X = fib(2 \times N) \wedge Y = fib(2 \times N + 1)$, which by weakening tells us that $X = fib(2 \times N)$.




        
    \end{enumerate}
\end{document}
